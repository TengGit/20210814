"use strict";!function(t){function n(t,i){for(var n=0;n<t.length;n++)t[n].call(void 0,i)}function o(t,i,n,e){this.reset(t,i,n,e||null)}function u(t,i){for(var n=0,e=0;e<t.length;e++)n=n*i+t[e];return n}o.cubicBezier=function(o,a,h,c){return function(t){for(var i=[3*o-3*h+1,-6*o+3*h,3*o,-t],n=[9*o-9*o+3,-12*o+6*h,3*o],e=[3*a-3*c+1,-6*a+3*c,3*a,0],r=u(i,t),s=-u(i,r);.001<Math.abs(s);)r+=s/Math.max(u(n,r),1),s=-u(i,r);return u(e,r)}},o.linear=function(t){return t},o.easeIn=o.cubicBezier(.42,0,1,1),o.easeOut=o.cubicBezier(0,0,.58,1),o.ease=o.cubicBezier(.25,.1,.25,1),o.easeInOut=o.cubicBezier(.42,0,.58,1),o.prototype.start=function(){return this._counter||(this._counter=setInterval(function(t){t.progress(t._progress+t._step)},this._interval,this)),this._started=!0,this},o.prototype.stop=function(){return this._counter&&(clearInterval(this._counter),this._counter=null),this},o.prototype.progress=function(t){if(t<0&&(t=0),1<t&&(t=1),this._progress!==t){for(var i in this._progress=t,this._first)this.target[i]=this._first[i]+this._delta[i]*this._func(t);n(this._callback,this),this._loop?(1==t&&0<this._step||0==t&&this._step<0)&&(this._step=-this._step):1==t&&n(this.stop()._onfinish,this)}return this},o.prototype.restart=function(){return this.stop().start()},o.prototype.cancel=function(){return this.stop().progress(0)},o.prototype.finish=function(){return this.stop().progress(1)},o.prototype.running=function(){return!!this._counter},o.prototype.reset=function(t,i,n,e){if(this.stop(),this.target=t,this.data=null,this._ms=n,this._step=1e3/(25*n),this._callback=[],this._interval=40,this._counter=null,this._first={},this._delta={},this._progress=0,this._onfinish=[],this._started=!1,this._func=o.linear,this._loop=!1,e)for(var r in e){var s=e[r];this._first[s]=+t[s],this._delta[s]=i[s]-this._first[s]}else for(var s in i)this._first[s]=+t[s],this._delta[s]=i[s]-this._first[s];return this},o.prototype.animate=function(t){return this._callback.push(t),this},o.prototype.then=function(t){return this._onfinish.push(t),this._started&&!this._counter&&t.call(void 0,this),this},o.prototype.setData=function(t){return this.data=t,this},o.prototype.setFunc=function(t){return this._func=t,this},o.prototype.fps=function(t){return this._interval=1e3/t,this._step=1e3/(this._ms*t),this._counter&&this.restart(),this},o.prototype.loop=function(t){this._loop=!!t},o.nullAnimation=function(){var t=new o([],[],1);return t.start=function(){return this._started=!0,this.finish(),this},t.progress=function(){return this.stop(),n(this._callback,this),n(this._onfinish,this),this},t},t.Animate=o}(window),function(t){t.nullTransistion=function(){return Animate.nullAnimation().start()},t.fadeIn=function(t,i){return t.style.opacity=0,new Animate(t.style,{opacity:1},i).setFunc(Animate.easeOut).start()},t.fadeOut=function(t,i){return t.style.opacity=1,new Animate(t.style,{opacity:0},i).setFunc(Animate.easeOut).start()},t.fadeOutAndDelete=function(t,i){return t.style.opacity=1,new Animate(t.style,{opacity:0},i).setFunc(Animate.easeOut).setData(t).then(function(t){t.data.parentNode.removeChild(t.data)}).start()}}(window);var res=[];!function(u){function e(t,i){for(var n in i)"object"==typeof i[n]&&null!==i[n]?e(t[n],i[n]):t[n]=i[n];return t}function r(t,i){return e(document.createElement(t),i=i||[])}function a(t,i){return e(u.resource.getResult(t),i=i||[])}function l(t,i){return void 0!==t?t:i}function s(t,i,n){return t.length>i&&void 0!==t[i]?t[i]:n}function h(t){return Math.round(1e3*t)/10+"%"}function o(t,i){return function(){t(i)}}function t(t,i,n,e){this._book=t,this._width=i,this._height=n,this._data=e||{},this._chapter=0,this._para=0,this._background=null,this._imlist=[],this._container=null,this._bgcontainer=r("div",{className:"widget full",id:"background-container"}),this._fgcontainer=r("div",{className:"widget full",id:"foreground-container"}),this._animate=[],this._disabled=!1,this._inclick=!1}function c(t,i){var n,e,r=[t],s=(n=i=i||{},e=this._data,l(n.transArg,l(e.transArg,[])));for(var o in s)r.push(s[o]);var a,h,c=(a=i,h=this._data,l(a.trans,l(h.trans,u.nullTransistion)).apply(this,r));return this._animate.push(c),c}function n(){this._animate&&function(){for(var t=0;t<this._animate.length;t++)this._animate[t].finish();this._animate=[]}.apply(this);var t=this._book[this._chapter][this._para];t[0].call(this,t)}function p(t,i,n,e,r,s){var o=a(t,{className:"widget",style:{left:h(i/e),top:h(n/r)}});return o.style.width=h(l(s.width,o.naturalWidth/e)),o.style.height=h(l(s.height,o.naturalHeight/r)),o}t.prototype.start=function(t){(this._container=t).appendChild(this._bgcontainer),t.appendChild(this._fgcontainer),this._chapter=this._para=0,n.apply(this),t.addEventListener("click",o(function(t){t._disabled||t._inclick||(t._inclick=!0,t.next(),t._inclick=!1)},this))},t.prototype.next=function(){if(++this._para>=this._book[this._chapter].length)throw new RangeError("Non-ending chapter ended without a jump");n.apply(this)},t.prototype.gotoChapter=function(t){this._chapter=t;for(var i=this._para=0;i<this._imlist.length;i++)this._fgcontainer.removeChild(this._imlist[i]);this._imlist=[],n.apply(this)},t.prototype.disableClickNext=function(){this._disabled=!0},t.prototype.enableClickNext=function(){this._disabled=!1},t.clbg=function(t){this.disableClickNext(),c.call(this,this._background,{trans:window.fadeOut,transArg:l(this._data.transArg,[1500])}).then(o(function(t){t._bgcontainer.removeChild(t._background),t._background=null,t.enableClickNext(),t._fgcontainer.click()},this))},t.clsd=function(t){for(var i=0;i<this._imlist.length;i++)this._fgcontainer.removeChild(this._imlist[i]);this._imlist=[],this._fgcontainer.click()},t.bg=function(t){this.disableClickNext();var i=a(t[1],{className:"widget full"});this._background!==i?(c.call(this,i,2<t.length?t[2]:{}).then(o(function(t){var i=t[0];i._background&&i._bgcontainer.removeChild(i._background),i._background=t[1],i.enableClickNext(),t[1].click()},[this,i])),this._bgcontainer.appendChild(i)):this.enableClickNext()},t.img=function(t){var i=p(t[1],t[2],t[3],this._width,this._height,s(t,4,{}));c.call(this,i,4<t.length?t[4]:{}).then(o(function(t){t.click()},i)),this._fgcontainer.appendChild(i),this._imlist.push(i)},t.ed=function(t){this.disableClickNext();var i=a(t[1],{className:"widget full"});c.call(this,i,2<t.length?t[2]:{}).then(o(function(t){var i=t[0];i._background&&i._bgcontainer.removeChild(i._background),i._background=null},[this,i])),this._fgcontainer.appendChild(i),this._imlist.push(i)},t.jmp=function(t){this.gotoChapter(t[1])},t.pause=function(t){},t.choice=function(t){this.disableClickNext();for(var i=1;i<t.length;i++){var n=t[i],e=p(n[0],n[1],n[2],this._width,this._height,s(n,4,{}));e.classList.add("option"),c.call(this,e,4<n.length?n[4]:{}).then(o(function(t){t[1].addEventListener("click",o(function(t){t[0].enableClickNext(),t[0].gotoChapter(t[1])},[t[0],t[2][3]]))},[this,e,n])),this._fgcontainer.appendChild(e),this._imlist.push(e)}},u.Story=t}(window),function(t,i,n,e){var d=1750,s=640/1136,g=91,_=325,y=810,r="img/{0}.png";function o(t){return i.querySelector(t)}function a(t){for(var i=1;i<arguments.length;i++)t=t.replace(new RegExp("\\{"+(i-1).toString()+"\\}","g"),arguments[i]);return t}function h(){var t=o("#root"),i=document.body.clientWidth,n=document.body.clientHeight,e=i,r=n;e/r<s?r=e/s:e=r*s,t.style.width=e+"px",t.style.height=r+"px",t.style.top=(n-r)/2+"px",t.style.left=(i-e)/2+"px"}function b(t){return{src:a(r,t),id:t,type:e.IMAGE}}for(var c=[],u=1;u<=7;u++)c.push({src:a("img/e{0}.jpg",u),id:"e"+u.toString(),type:e.IMAGE,preferXHR:!1});for(u=1;u<=5;u++)c.push(b("bg"+u.toString()));var l=[[[Story.jmp,8]]];for(u=0;u<7;u++)l.push([[Story.clbg],[Story.ed,"e"+(u+1).toString()]]);l[0][0][1]=function t(i,n,e,r,s,o){var a;if("number"==typeof e[2]){a=[[Story.bg,"bg"+r.toString()]];for(var h=0;h<e[0];h++){if(e[1]==h){var c=e[3]+e[0].toString().padStart(2,"0");n.push(b(c)),a.push([Story.img,c,0,0,{trans:fadeIn,transArg:[d]}])}c=e[3]+h.toString().padStart(2,"0"),n.push(b(c)),a.push([Story.img,c,0,0])}e[1]==e[0]&&(c=e[3]+e[0].toString().padStart(2,"0"),n.push(b(c)),a.push([Story.img,c,0,0,{trans:fadeIn,transArg:[d]}])),a.push([Story.pause]),a.push([Story.jmp,e[2]])}else{a=[[Story.bg,"bg"+(r+1).toString()]],s.length<=r&&s.push(0),o.length<=r&&o.push(0);var u=s[r]++;for(h=0;h<e[0];h++)e[1]==h&&(c=r.toString()+u.toString()+e[0].toString().padStart(2,"0"),n.push(b(c)),a.push([Story.img,c,0,0,{trans:fadeIn,transArg:[d]}])),c=r.toString()+u.toString()+h.toString().padStart(2,"0"),n.push(b(c)),a.push([Story.img,c,0,0]);e[1]==e[0]&&(c=r.toString()+u.toString()+e[0].toString().padStart(2,"0"),n.push(b(c)),a.push([Story.img,c,0,0,{trans:fadeIn,transArg:[d]}]));var l=o[r],p="b"+r.toString()+l.toString(),f="b"+r.toString()+(l+1).toString();o[r]+=2,n.push(b(p)),n.push(b(f)),a.push([Story.choice,[p,g,y,t(i,n,e[2],r+1,s,o),{trans:fadeIn,transArg:[d]}],[f,_,y,t(i,n,e[3],r+1,s,o),{trans:fadeIn,transArg:[d]}]])}return i.push(a),i.length-1}(l,c,[4,4,[6,3,[5,3,[7,4,[9,4,1,"33"],[9,4,3,"34"]],[9,5,6,"24"]],[11,4,[6,1,[2,1,[4,0,4,"42"],[6,3,5,"43"]],[10,9,1,"35"]],[8,7,2,"25"]]],[6,1,[10,0,[11,9,7,"26"],[11,3,5,"27"]],[6,3,[8,4,[7,3,[4,0,4,"42"],[6,3,5,"43"]],[7,0,6,"36"]],[6,1,3,"28"]]]],0,[],[]),t.addEventListener("load",function(){h(),n.on("progress",function(t){var i=Math.floor(100*t.progress)+"%";o("#percent").textContent=i,o("#progress-bar").style.width=i}),n.on("complete",function(){o("#percent").textContent="Loaded!",o("#progress-bar").style.width="100%";var t=o("#start");t.style.visibility="visible";var i=o("#click-to-start");i.style.visibility="visible",fadeIn(i,1e3).setData(t).then(function(t){t.data.onclick=function(){this.onclick=null,fadeOutAndDelete(o("#progress-container"),1e3),fadeOutAndDelete(this,1e3).then(function(){new Story(l,640,1136,{trans:fadeIn,transArg:[1e3]}).start(o("#root"))})}})}),n.loadManifest(c)}),t.addEventListener("resize",h),t.resource=n}(window,document,new createjs.LoadQueue,createjs.Types);